.diagnostics-container {
  width: 100%;
  height: 100vh;
  min-height: 100vh;
  padding: 0;
  /* spacing variables: header height + gap used to position the welcome title nicely below the Header */
  /* prefer using header's canonical CSS variable when available */
  --diagnostics-header-height: var(--app-header-height, 120px);
  --diagnostics-title-gap: 18px;
  /* mobile overrides (used inside media queries) */
  --diagnostics-header-height-mobile: calc(var(--app-header-height, 100px));
  --diagnostics-title-gap-mobile: 8px; /* smaller gap on mobile so title sits closer to header */
  background-image: 
    url("data:image/svg+xml,%3Csvg width='100' height='100' xmlns='http://www.w3.org/2000/svg'%3E%3Cdefs%3E%3Cpattern id='grid' width='100' height='100' patternUnits='userSpaceOnUse'%3E%3Cpath d='M 100 0 L 0 0 0 100' fill='none' stroke='rgba(255,255,255,0.08)' stroke-width='1'/%3E%3C/pattern%3E%3C/defs%3E%3Crect width='100' height='100' fill='url(%23grid)'/%3E%3C/svg%3E"),
    url("data:image/svg+xml,%3Csvg width='200' height='200' xmlns='http://www.w3.org/2000/svg'%3E%3Cdefs%3E%3Cpattern id='circuit' width='200' height='200' patternUnits='userSpaceOnUse'%3E%3Ccircle cx='25' cy='25' r='2' fill='rgba(92,184,92,0.1)'/%3E%3Ccircle cx='175' cy='175' r='2' fill='rgba(74,144,226,0.1)'/%3E%3Cpath d='M 50 50 L 150 50 L 150 150 L 50 150 Z' fill='none' stroke='rgba(255,255,255,0.03)' stroke-width='1'/%3E%3C/pattern%3E%3C/defs%3E%3Crect width='200' height='200' fill='url(%23circuit)'/%3E%3C/svg%3E"),
    radial-gradient(circle at 20% 30%, rgba(92, 184, 92, 0.1), transparent 50%),
    radial-gradient(circle at 80% 70%, rgba(74, 144, 226, 0.1), transparent 50%),
    linear-gradient(180deg, #0a0a0f, #0c0c14);
  position: relative;
  overflow-x: hidden;
  /* allow page-level scrolling so intro can scroll on mobile */
  overflow-y: auto;
  scrollbar-width: none;
  -ms-overflow-style: none;
  display: flex;
  flex-direction: column;
}

/* Force container to start at the very top so Header overlays it consistently
   (keeps behaviour identical between Diagnostics and Ikigai flows). */
.diagnostics-container {
  margin-top: 0 !important;
  padding-top: 0 !important;
}

/* Space reserved for answer options area. Other components read this to avoid overlap.
   We compute the total reserved area from smaller building blocks so other
   styles (and Alchemy) can align the fixed back button and the answer options
   reliably. */
:root {
  /* Height of the fixed "Вернуться к столу" button area (incl. touch target) */
  --back-to-table-button-height: 56px;
  /* Small gap between the button top and the last answer option */
  --back-to-table-gap: 12px;
  /* Approximate height reserved for the stack of answer options themselves. */
  --answers-area-height: 84px;

  /* Total area to reserve at the bottom of the question panel so answers and
     the fixed button won't overlap. Other components may read this variable. */
  --diagnostics-answer-area-height: calc(var(--back-to-table-button-height) + var(--back-to-table-gap) + var(--answers-area-height)); /* desktop default */
}

/* Tweak the answer-area height for different breakpoints so the parent
   (Alchemy) can place the fixed "Вернуться к столу" button below the
   options reliably across devices. These overrides update the same
   CSS variable so calc(...) in JS/CSS keeps working. */
@media (max-width: 1024px) {
  :root { --diagnostics-answer-area-height: 130px; }
}
@media (max-width: 768px) {
  :root { --diagnostics-answer-area-height: 120px; }
}
@media (max-width: 480px) {
  :root { --diagnostics-answer-area-height: 110px; }
}

/* Для страницы результатов разрешаем скроллинг */
.diagnostics-container-results {
  overflow-y: scroll !important;
  overflow-x: hidden !important;
  height: 100vh !important;
  scrollbar-width: none !important;
  -ms-overflow-style: none !important;
}

.diagnostics-container-results::-webkit-scrollbar {
  display: none !important;
  width: 0 !important;
  height: 0 !important;
}

.diagnostics-container::-webkit-scrollbar {
  display: none;
}


/* Убираем скроллбар для вариантов ответов (скроллинг не нужен) */

/* Вводный экран */
.diagnostics-intro {
  width: 100%;
  min-height: 100vh;
  display: flex;
  align-items: flex-start;
  justify-content: center;
  /* Do not push the whole intro block down by header height — keep the
     background/full-panel starting at the top of the viewport so Header
     visually overlays it. Position the first visible element (title) by
     applying a margin equal to header height below. */
  padding: 0 20px 40px;
  overflow-y: auto;
  scrollbar-width: none;
  -ms-overflow-style: none;
  -webkit-overflow-scrolling: touch; /* smooth scrolling on iOS */
}

.diagnostics-intro::-webkit-scrollbar {
  display: none;
  width: 0;
  height: 0;
}

.diagnostics-intro-content {
  max-width: 800px;
  margin: 0 auto;
  text-align: center;
  animation: fadeInUp 0.6s ease-out;
  display: flex;
  flex-direction: column;
  gap: 16px;
}

/* Place the intro content (title block) under the fixed header using margin
   so the diagnostics panel background remains at the top of the viewport. */
.diagnostics-intro-content {
  margin-top: calc(var(--app-header-height, 120px));
}

.diagnostics-start-btn {
  margin-top: 20px !important;
}

.diagnostics-intro-title {
  color: #ffffff;
  font-size: 42px;
  font-weight: 700;
  /* visual gap between header and title is applied here so we can
     tune it independently of the container padding used to reserve
     the header area. This keeps Diagnostics and Ikigai consistent. */
  /* title gap is relative to header and is additive to the top offset from
     .diagnostics-intro-content. Keep a small visual separation controlled
     by --diagnostics-title-gap. */
  margin: var(--diagnostics-title-gap, 18px) 0 24px;
  padding-top: 0;
  position: relative;
  text-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
  line-height: 1.2;
  background: linear-gradient(135deg, #ffffff, rgba(255, 255, 255, 0.85));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

/* Decorative accent above the title to make the gap look intentional */
.diagnostics-intro-title::before {
  content: '';
  display: block;
  width: 68px;
  height: 4px;
  margin: 0 auto 14px;
  border-radius: 3px;
  background: linear-gradient(90deg, rgba(92,184,92,0.95), rgba(74,144,226,0.95));
  box-shadow: 0 4px 12px rgba(0,0,0,0.35);
  opacity: 0.95;
}

.diagnostics-intro-subtitle {
  color: rgba(255, 255, 255, 0.85);
  font-size: 18px;
  line-height: 1.6;
  margin: 0 0 40px;
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
}

/* Стили для Икигай welcome экрана */
.ikigai-intro-main {
  font-size: 20px;
  font-weight: 500;
  margin-bottom: 16px;
  color: rgba(255, 255, 255, 0.95);
}

.ikigai-intro-sub {
  font-size: 16px;
  margin-bottom: 24px;
  color: rgba(255, 255, 255, 0.8);
  font-style: italic;
}

.ikigai-instruction {
  font-size: 14px;
  line-height: 1.4;
  color: rgba(255, 255, 255, 0.75);
  margin-top: 16px;
  padding: 20px;
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 12px;
  backdrop-filter: blur(10px);
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
}

.ikigai-instruction strong {
  color: rgba(255, 255, 255, 0.95);
  font-weight: 600;
  display: block;
  margin-bottom: 12px;
  font-size: 16px;
}

.ikigai-instruction-list {
  margin: 0;
  padding: 0;
  list-style: none;
}

.ikigai-instruction-item {
  display: flex;
  align-items: flex-start;
  margin-bottom: 10px;
  padding: 8px 0;
  border-bottom: 1px solid rgba(255, 255, 255, 0.05);
}

.ikigai-instruction-item:last-child {
  border-bottom: none;
  margin-bottom: 0;
}

.ikigai-instruction-emoji {
  font-size: 18px;
  margin-right: 12px;
  flex-shrink: 0;
  margin-top: 2px;
}

.ikigai-instruction-content {
  flex: 1;
  text-align: left;
}

.ikigai-instruction-title {
  font-weight: 600;
  color: rgba(255, 255, 255, 0.9);
  margin-bottom: 4px;
  font-size: 14px;
}

.ikigai-instruction-text {
  color: rgba(255, 255, 255, 0.75);
  line-height: 1.4;
  margin: 0;
}

.diagnostics-start-btn {
  background: linear-gradient(135deg, #5cb85c 0%, #4a9e4a 50%, #5cb85c 100%);
  background-size: 200% 200%;
  border: none;
  color: #ffffff;
  font-size: 18px;
  font-weight: 600;
  padding: 16px 48px;
  border-radius: 12px;
  cursor: pointer;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(92, 184, 92, 0.4), 0 1px 0 rgba(255, 255, 255, 0.15) inset;
  letter-spacing: 0.3px;
  position: relative;
  overflow: hidden;
}

.diagnostics-start-btn::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
  transition: left 0.5s ease;
}

.diagnostics-start-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 28px rgba(92, 184, 92, 0.5), 0 1px 0 rgba(255, 255, 255, 0.2) inset;
  background-position: 100% 0;
}

.diagnostics-start-btn:hover::before {
  left: 100%;
}

.diagnostics-start-btn:active {
  transform: translateY(0);
  box-shadow: 0 2px 12px rgba(92, 184, 92, 0.3);
}

/* Экран вопроса */
.diagnostics-question {
  width: 100%;
  height: 100%;
  flex: 1;
  min-height: 0;
  /* Отступ сверху учитывает фиксированный Header. Используем каноническую
     переменную --app-header-height для одинаковой привязки во всех тестах.
     Уберём дополнительный смещение (+8px), чтобы Икигай не стартовал ниже.
     Если нужно дополнительное пространство для прогресс-бара, оно задаётся
     локально через margin у .diagnostics-progress. */
  padding-top: calc(var(--app-header-height, 120px));
  padding-left: 20px;
  padding-right: 20px;
  padding-bottom: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  overflow: hidden;
  box-sizing: border-box;
  margin: 0;
  position: relative;
}

.diagnostics-progress {
  width: 100%;
  max-width: 800px;
  margin-bottom: 12px;
  flex-shrink: 0;
  position: relative;
  z-index: 100;
  padding: 8px 0;
  box-sizing: border-box;
}

.progress-bar {
  width: 100%;
  height: 6px;
  background: rgba(255, 255, 255, 0.15);
  border-radius: 3px;
  overflow: hidden;
  margin-bottom: 6px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3), inset 0 1px 2px rgba(0, 0, 0, 0.2);
  border: 1px solid rgba(255, 255, 255, 0.1);
}

.progress-bar-fill {
  height: 100%;
  background: linear-gradient(90deg, #5cb85c, #4a9e4a);
  border-radius: 4px;
  transition: width 0.4s ease;
  box-shadow: 0 0 12px rgba(92, 184, 92, 0.6), inset 0 1px 0 rgba(255, 255, 255, 0.2);
}

.progress-text {
  color: rgba(255, 255, 255, 0.9);
  font-size: 12px;
  text-align: center;
  font-weight: 600;
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
}

.question-content {
  width: 100%;
  max-width: 800px;
  animation: fadeInUp 0.5s ease-out;
  display: flex;
  flex-direction: column;
  flex: 1;
  min-height: 0;
  overflow: hidden;
  box-sizing: border-box;
  padding: 0 10px var(--diagnostics-answer-area-height, 140px) 10px; /* reserve space for absolute-positioned answer options */
  margin: 0;
  gap: 8px;
  justify-content: flex-start;
  position: relative;
}

.question-content-wrapper {
  display: flex;
  flex-direction: column;
  flex: 0 0 auto;
  min-height: 0;
  overflow: hidden;
  padding-left: 0;
  padding-right: 0;
  gap: 6px;
}

.question-stage {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  margin-bottom: 0;
  padding: 8px 14px;
  background: linear-gradient(135deg, 
    rgba(92, 184, 92, 0.2) 0%, 
    rgba(74, 144, 226, 0.2) 50%, 
    rgba(92, 184, 92, 0.15) 100%);
  backdrop-filter: blur(20px);
  border: 2px solid rgba(0, 255, 136, 0.3);
  border-radius: 10px;
  box-shadow: 
    0 0 20px rgba(0, 255, 136, 0.2),
    0 4px 20px rgba(0, 0, 0, 0.3),
    inset 0 1px 0 rgba(255, 255, 255, 0.1);
  flex-shrink: 0;
  position: relative;
  overflow: hidden;
  animation: questionStageGlow 3s ease-in-out infinite;
  width: 100%;
  box-sizing: border-box;
}

.question-stage > div:not(.question-stage-image) {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0;
  position: relative;
  z-index: 1;
}

.question-stage::before {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: radial-gradient(circle, rgba(0, 255, 136, 0.15) 0%, transparent 70%);
  animation: questionStageRotate 8s linear infinite;
  pointer-events: none;
}

.question-stage::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(135deg, 
    transparent 0%,
    rgba(255, 255, 255, 0.05) 50%,
    transparent 100%);
  pointer-events: none;
  animation: questionStageShine 4s ease-in-out infinite;
}

@keyframes questionStageGlow {
  0%, 100% {
    box-shadow: 
      0 0 20px rgba(0, 255, 136, 0.2),
      0 4px 20px rgba(0, 0, 0, 0.3),
      inset 0 1px 0 rgba(255, 255, 255, 0.1);
    border-color: rgba(0, 255, 136, 0.3);
  }
  50% {
    box-shadow: 
      0 0 30px rgba(0, 255, 136, 0.4),
      0 6px 30px rgba(0, 0, 0, 0.4),
      inset 0 1px 0 rgba(255, 255, 255, 0.15);
    border-color: rgba(0, 255, 136, 0.5);
  }
}

@keyframes questionStageRotate {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

@keyframes questionStageShine {
  0%, 100% {
    opacity: 0;
    transform: translateX(-100%);
  }
  50% {
    opacity: 1;
    transform: translateX(100%);
  }
}

.question-stage-image {
  width: 60px;
  height: 60px;
  object-fit: cover;
  border-radius: 10px;
  border: 2px solid rgba(0, 255, 136, 0.4);
  flex-shrink: 0;
  box-shadow:
    0 0 15px rgba(0, 255, 136, 0.3),
    0 2px 8px rgba(0, 0, 0, 0.3);
  position: relative;
  z-index: 1;
  transition: all 0.3s ease;
}

.question-stage-emoji {
  width: 60px;
  height: 60px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 36px;
  border-radius: 10px;
  border: 2px solid rgba(0, 255, 136, 0.4);
  flex-shrink: 0;
  box-shadow:
    0 0 15px rgba(0, 255, 136, 0.3),
    0 2px 8px rgba(0, 0, 0, 0.3);
  position: relative;
  z-index: 1;
  transition: all 0.3s ease;
  background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
}

.question-stage:hover .question-stage-image,
.question-stage:hover .question-stage-emoji {
  border-color: rgba(0, 255, 136, 0.6);
  box-shadow:
    0 0 20px rgba(0, 255, 136, 0.5),
    0 4px 12px rgba(0, 0, 0, 0.4);
  transform: scale(1.02);
}

.question-stage-name {
  color: #ffffff;
  font-size: 18px;
  font-weight: 700;
  margin: 0 0 2px 0;
  text-shadow: 
    0 2px 8px rgba(0, 0, 0, 0.5),
    0 0 10px rgba(0, 255, 136, 0.3);
  text-align: center;
  position: relative;
  z-index: 1;
  background: linear-gradient(135deg, #ffffff 0%, rgba(0, 255, 136, 0.9) 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  letter-spacing: 0.3px;
  line-height: 1.2;
}

.question-stage-subtitle {
  color: rgba(255, 255, 255, 0.7);
  font-size: 11px;
  font-weight: 400;
  margin: 0;
  text-align: center;
  position: relative;
  z-index: 1;
  font-style: italic;
  letter-spacing: 0.2px;
  line-height: 1.2;
}

/* Обертка для сообщений с аватаркой */
.message-wrapper {
  display: flex;
  align-items: flex-start;
  gap: 6px;
  margin-bottom: 0;
  flex-shrink: 0;
  overflow: visible;
  position: relative;
  z-index: 1;
  width: 100%;
  box-sizing: border-box;
}

.message-wrapper-left {
  justify-content: flex-start;
}

.message-wrapper-right {
  justify-content: flex-end;
}

.message-avatar {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  object-fit: cover;
  border: 2px solid rgba(255, 255, 255, 0.2);
  flex-shrink: 0;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
}

/* Стиль сообщения с вопросом (от меня, слева) */
.question-message {
  background: linear-gradient(135deg, rgba(92, 184, 92, 0.25), rgba(74, 144, 226, 0.25));
  backdrop-filter: blur(20px);
  border: 1px solid rgba(92, 184, 92, 0.3);
  border-radius: 10px;
  padding: 10px 14px;
  margin-bottom: 0;
  margin-left: 12px;
  position: relative;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
  opacity: 1;
  transform: translateX(0);
  flex-shrink: 0;
  max-width: 60%;
  overflow: visible;
  margin-top: 0;
}

/* Стрелка влево для вопроса - элемент в JSX - бледная, прозрачная, приплюснутая по вертикали */
.message-arrow {
  position: absolute;
  top: 50%;
  transform: translateY(-50%) scaleX(0.6) scaleY(1.8);
  font-size: 24px;
  font-weight: 700;
  z-index: 20;
  line-height: 1;
  pointer-events: none;
  display: inline-block;
  opacity: 0.8;
  filter: drop-shadow(0 0 4px currentColor);
}

.message-arrow-left {
  left: -16px;
  color: rgba(92, 184, 92, 0.9);
}

.message-arrow-right {
  right: -16px;
  color: rgba(255, 255, 255, 0.85);
}

.answer-message.poll-option.selected .message-arrow-right {
  color: rgba(51, 144, 236, 0.95);
  opacity: 0.9;
}

.question-message p {
  color: rgba(255, 255, 255, 0.95);
  font-size: 14px;
  line-height: 1.4;
  margin: 0;
  word-wrap: break-word;
  overflow-wrap: break-word;
}


/* Варианты ответов в стиле голосования Telegram (справа, компактно) */
.answer-options {
  /* Anchor answer options to the bottom-right corner of the question panel
     and place them above the fixed back-button. We compute bottom using the
     shared variables so the options will never be covered by the button. */
  display: flex;
  flex-direction: column;
  gap: 12px;
  align-items: flex-end;
  flex: 0 0 auto;
  overflow: visible;
  padding: 0;
  margin: 0;
  position: absolute;
  right: 12px;
  /* place options above the back-to-table button by the configured gap */
  bottom: calc(var(--back-to-table-button-height) + var(--back-to-table-gap));
  width: min(420px, 46%);
  max-width: 420px;
  box-sizing: border-box;
  z-index: 80;
}

/* Ensure the fixed "Вернуться к столу" button used in some flows
   does not overlap the answer options. When the button lives inside
   .action-zone-inner we want it to be pinned below the options — so
   increase stacking context and ensure it appears below answers visually.
   Also provide a small bottom offset so it's not flush to the viewport. */
.action-zone-inner .back-to-table-button {
  position: sticky;
  bottom: 12px; /* small offset from bottom of visible area */
  margin-top: 12px;
  z-index: 90; /* above most content but below interactive overlays */
}

/* When Diagnostics is rendered standalone (Ikigai opened from Alchemy)
   a fixed back button is positioned above the reserved answer area using
   --diagnostics-answer-area-height. Keep its bottom offset to be at least
   that variable to avoid overlapping answer options. */
.fixed-back-to-table {
  position: fixed;
  left: 50%;
  transform: translateX(-50%);
  /* Allow JS to set an exact bottom offset based on the rendered
     .question-content element. If JS doesn't set --fixed-back-bottom,
     fall back to the diagnostics reserved area. */
  bottom: var(--fixed-back-bottom, var(--diagnostics-answer-area-height, 140px));
  /* Raised z-index so the button remains on top and interactable */
  z-index: 200;
}

/* Styling for the fixed back button when Ikigai is opened as standalone
   overlay. Ensure it visually sits below the answer options area, has
   consistent height and touch target and doesn't overlap the options. */
.fixed-back-to-table .back-to-table-button {
  height: var(--back-to-table-button-height, 56px);
  min-height: var(--back-to-table-button-height, 56px);
  padding: 0 20px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(135deg, #5cb85c 0%, #4a9e4a 50%);
  color: #fff;
  border: none;
  border-radius: 12px;
  box-shadow: 0 8px 24px rgba(0,0,0,0.32), 0 2px 8px rgba(76, 175, 80, 0.18);
  cursor: pointer;
  z-index: 210; /* be above answer options (which have z-index:80) */
  -webkit-tap-highlight-color: transparent;
}

/* Small screens: make the fixed button span wider and keep comfortable touch area */
@media (max-width: 768px) {
  .fixed-back-to-table {
    left: 50%;
    transform: translateX(-50%);
  }

  .fixed-back-to-table .back-to-table-button {
    width: calc(100% - 40px);
    max-width: 520px;
    border-radius: 10px;
  }
}

.answer-message.poll-option {
  width: 100%;
  min-width: 0;
  max-width: 420px;
  height: auto; /* allow height to fit content */
  /* Keep minimum small so single-line labels remain compact, but otherwise
     let the content determine height so multi-line labels expand naturally. */
  min-height: 34px;
  padding: 8px 12px; /* reduced padding to keep buttons compact */
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(20px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.18s ease;
  text-align: left;
  flex-shrink: 0;
  box-sizing: border-box;
  position: relative;
  margin: 0;
  opacity: 1;
  transform: translateX(0);
  overflow: hidden;
  display: flex;
  align-items: flex-start; /* allow multi-line labels to expand height naturally */
  touch-action: manipulation;
  -webkit-tap-highlight-color: rgba(51, 144, 236, 0.3);
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
}

.answer-message.poll-option:first-child {
  border-top-left-radius: 12px;
  border-top-right-radius: 12px;
}

.answer-message.poll-option:last-child {
  border-bottom-left-radius: 12px;
  border-bottom-right-radius: 12px;
}

.answer-message.poll-option:not(:first-child) {
  border-top: 1px solid rgba(255, 255, 255, 0.15);
  border-top-left-radius: 0;
  border-top-right-radius: 0;
}

.answer-message.poll-option:not(:last-child) {
  border-bottom: none;
  border-bottom-left-radius: 0;
  border-bottom-right-radius: 0;
}

.answer-message.poll-option:only-child {
  border-radius: 12px;
}

/* Убираем все псевдоэлементы - стрелки теперь в JSX */
.question-message::before,
.question-message::after,
.answer-message.poll-option::before,
.answer-message.poll-option::after {
  display: none !important;
  content: none !important;
}

.answer-message.poll-option:hover,
.answer-message.poll-option:active {
  background: rgba(255, 255, 255, 0.15);
  transform: translateX(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
}

.answer-message.poll-option.selected:active {
  background: linear-gradient(135deg, rgba(51, 144, 236, 0.45), rgba(33, 150, 243, 0.4));
  box-shadow: 0 4px 20px rgba(51, 144, 236, 0.5);
}

.answer-message.poll-option.selected {
  background: linear-gradient(135deg, rgba(51, 144, 236, 0.35), rgba(33, 150, 243, 0.3));
  border-color: rgba(51, 144, 236, 0.5);
  box-shadow: 0 4px 16px rgba(51, 144, 236, 0.4);
}


.poll-checkmark {
  position: absolute;
  right: 30px;
  top: 50%;
  transform: translateY(-50%);
  color: #ffffff;
  font-size: 16px;
  font-weight: bold;
  width: 24px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(255, 255, 255, 0.2);
  border-radius: 50%;
  z-index: 14;
}

/* Убираем галочку у последнего элемента, если он выбран - там стрелка */


.answer-option-label {
  color: rgba(255, 255, 255, 0.95);
  font-size: 13px;
  font-weight: 500;
  margin-bottom: 0;
  line-height: 1.3;
  padding-right: 30px;
  word-break: break-word;
  overflow-wrap: break-word;
  hyphens: auto;
}

.answer-message.poll-option.selected .answer-option-label {
  color: #ffffff;
  font-weight: 600;
}

.answer-option-description {
  color: rgba(255, 255, 255, 0.7);
  font-size: 12px;
  font-weight: 400;
  margin: 0;
  line-height: 1.3;
  padding-right: 30px;
  word-break: break-word;
  overflow-wrap: break-word;
  hyphens: auto;
}

.answer-message.poll-option.selected .answer-option-description {
  color: rgba(255, 255, 255, 0.85);
}

/* Экран результатов */
.diagnostics-results {
  width: 100%;
  /* keep results below the fixed header reliably using the canonical header variable */
  min-height: calc(100vh - var(--app-header-height));
  padding: calc(var(--app-header-height) + 12px) 20px 60px;
  display: flex;
  align-items: flex-start;
  justify-content: center;
  box-sizing: border-box;
}

.diagnostics-results-content {
  width: 100%;
  max-width: 1000px;
  animation: fadeInUp 0.6s ease-out;
  box-sizing: border-box;
}
.diagnostics-results-title {
  color: #ffffff;
  font-size: 42px;
  font-weight: 700;
  /* reduce and stabilise vertical spacing so scaling won't push title under/over header */
  margin: 0 0 24px;
  text-align: center;
  text-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
  background: linear-gradient(135deg, #ffffff, rgba(255, 255, 255, 0.85));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

/* Make the results title stick just below the fixed header so it's always
   visible on screen. We use the canonical --app-header-height variable from
   Header.css and add a small offset so the title doesn't touch the header. */
.diagnostics-results-title {
  position: sticky;
  top: calc(var(--app-header-height, 120px) + 8px);
  z-index: 150; /* above most content but below header's top-most overlays */
  margin-top: 0; /* reset any additional spacing so sticky positioning is predictable */
  padding-top: 4px; /* small breathing room */
  background-clip: text;
}

.funnel-visualization {
  display: flex;
  flex-direction: column;
  gap: 18px;
  margin-bottom: 24px;
}

.funnel-stage-result {
  background: linear-gradient(135deg, rgba(255, 255, 255, 0.12), rgba(255, 255, 255, 0.08));
  backdrop-filter: blur(20px);
  border: 2px solid rgba(255, 255, 255, 0.15);
  border-radius: 16px;
  padding: 24px;
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
  transition: all 0.3s ease;
}

.funnel-stage-result:hover {
  transform: translateX(8px);
  box-shadow: 0 6px 24px rgba(0, 0, 0, 0.3);
}

.funnel-stage-result.critical {
  border-color: rgba(217, 83, 79, 0.5);
}

.funnel-stage-result.unstable {
  border-color: rgba(240, 173, 78, 0.5);
}

.funnel-stage-result.strong {
  border-color: rgba(92, 184, 92, 0.5);
}

.funnel-stage-header {
  display: flex;
  align-items: center;
  gap: 20px;
  margin-bottom: 16px;
}

.funnel-stage-image {
  width: 80px;
  height: 80px;
  object-fit: cover;
  border-radius: 12px;
  border: 2px solid rgba(255, 255, 255, 0.2);
  flex-shrink: 0;
}

.funnel-stage-info {
  flex: 1;
}

.funnel-stage-name {
  color: #ffffff;
  font-size: 24px;
  font-weight: 600;
  margin: 0 0 8px;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

.funnel-stage-score {
  font-size: 18px;
  font-weight: 700;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

.funnel-stage-bar {
  width: 100%;
  height: 12px;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 6px;
  overflow: hidden;
  margin-bottom: 16px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
}

.funnel-stage-bar-fill {
  height: 100%;
  border-radius: 6px;
  transition: width 0.8s ease;
  box-shadow: 0 0 12px rgba(92, 184, 92, 0.5);
}

.funnel-stage-recommendation {
  color: rgba(255, 255, 255, 0.85);
  font-size: 16px;
  line-height: 1.6;
  margin: 0;
}

.diagnostics-analysis {
  display: flex;
  flex-direction: column;
  gap: 24px;
  margin-bottom: 32px;
}

.analysis-section {
  background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
  backdrop-filter: blur(20px);
  border-radius: 16px;
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
  overflow: visible;
  display: flex;
  flex-direction: column;
}

.analysis-section-header {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 16px 20px;
  border-bottom: 2px solid rgba(255, 255, 255, 0.1);
}

.analysis-section-header.analysis-critical {
  background: linear-gradient(135deg, rgba(217, 83, 79, 0.15), rgba(217, 83, 79, 0.05));
  border-bottom-color: rgba(217, 83, 79, 0.3);
}

.analysis-section-header.analysis-unstable {
  background: linear-gradient(135deg, rgba(240, 173, 78, 0.15), rgba(240, 173, 78, 0.05));
  border-bottom-color: rgba(240, 173, 78, 0.3);
}

.analysis-section-header.analysis-strong {
  background: linear-gradient(135deg, rgba(92, 184, 92, 0.15), rgba(92, 184, 92, 0.05));
  border-bottom-color: rgba(92, 184, 92, 0.3);
}

.analysis-section-title {
  color: #ffffff;
  font-size: 18px;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 8px;
}

.analysis-count {
  font-size: 14px;
  font-weight: 400;
  color: rgba(255, 255, 255, 0.7);
}

.analysis-icon {
  font-size: 28px;
  flex-shrink: 0;
  line-height: 1;
}

.analysis-section-items {
  display: flex;
  flex-direction: column;
  padding: 8px;
  max-height: 400px;
  overflow-y: auto;
  overflow-x: hidden;
  scrollbar-width: thin;
  scrollbar-color: rgba(255, 255, 255, 0.3) rgba(255, 255, 255, 0.1);
}

.analysis-section-items::-webkit-scrollbar {
  width: 6px;
}

.analysis-section-items::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 3px;
}

.analysis-section-items::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.3);
  border-radius: 3px;
}

.analysis-section-items::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.5);
}

.analysis-item {
  display: flex;
  align-items: center;
  padding: 12px 16px;
  border-radius: 10px;
  margin: 4px;
  transition: all 0.2s ease;
}

.analysis-item:hover {
  background: rgba(255, 255, 255, 0.05);
  transform: translateX(4px);
}

.analysis-item-content {
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 100%;
  gap: 16px;
}

.analysis-item-name {
  color: #ffffff;
  font-size: 16px;
  line-height: 1.5;
  flex: 1;
}

.analysis-item-score {
  color: rgba(255, 255, 255, 0.7);
  font-size: 14px;
  font-weight: 600;
  flex-shrink: 0;
}

.analysis-item.analysis-critical .analysis-item-name {
  color: rgba(255, 200, 200, 0.95);
}

.analysis-item.analysis-critical .analysis-item-score {
  color: rgba(217, 83, 79, 0.9);
}

.analysis-item.analysis-unstable .analysis-item-name {
  color: rgba(255, 230, 180, 0.95);
}

.analysis-item.analysis-unstable .analysis-item-score {
  color: rgba(240, 173, 78, 0.9);
}

.analysis-item.analysis-strong .analysis-item-name {
  color: rgba(200, 255, 200, 0.95);
}

.analysis-item.analysis-strong .analysis-item-score {
  color: rgba(92, 184, 92, 0.9);
}

.diagnostics-conclusion {
  padding: 24px;
  background: linear-gradient(135deg, rgba(92, 184, 92, 0.15), rgba(74, 158, 74, 0.1));
  backdrop-filter: blur(20px);
  border: 2px solid rgba(92, 184, 92, 0.3);
  border-radius: 16px;
  margin-bottom: 32px;
  box-shadow: 0 4px 16px rgba(92, 184, 92, 0.2);
}

.conclusion-wrapper {
  display: flex;
  align-items: flex-start;
  gap: 16px;
}

.conclusion-avatar {
  width: 56px;
  height: 56px;
  border-radius: 50%;
  object-fit: cover;
  border: 2px solid rgba(255, 255, 255, 0.2);
  flex-shrink: 0;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
}

.conclusion-text {
  color: rgba(255, 255, 255, 0.95);
  font-size: 16px;
  line-height: 1.6;
  margin: 0;
  text-align: left;
  font-weight: 400;
  flex: 1;
  letter-spacing: 0.01em;
}

.conclusion-text strong {
  font-weight: 600;
  color: #ffffff;
  display: inline;
  font-size: 16px;
}

.conclusion-text br {
  display: block;
  content: "";
  margin-bottom: 4px;
  line-height: 1.5;
}

.conclusion-text br + br {
  margin-bottom: 12px;
}

.conclusion-text .list-marker {
  color: rgba(92, 184, 92, 0.85);
  font-weight: 600;
  margin-right: 8px;
  display: inline-block;
  font-size: 16px;
  vertical-align: baseline;
}

.conclusion-text .list-number {
  color: rgba(92, 184, 92, 0.85);
  font-weight: 600;
  margin-right: 8px;
  display: inline-block;
  vertical-align: baseline;
}

.diagnostics-consultation {
  display: flex;
  justify-content: center;
  margin-top: 40px;
  margin-bottom: 40px;
}

.diagnostics-consultation-btn {
  background: linear-gradient(135deg, #5cb85c 0%, #4a9e4a 50%, #5cb85c 100%);
  border: none;
  color: #ffffff;
  font-size: 18px;
  font-weight: 600;
  padding: 16px 48px;
  border-radius: 12px;
  cursor: pointer;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 4px 20px rgba(92, 184, 92, 0.4), 0 1px 0 rgba(255, 255, 255, 0.15) inset;
  letter-spacing: 0.3px;
  position: relative;
  overflow: hidden;
}

.diagnostics-consultation-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 28px rgba(92, 184, 92, 0.5), 0 1px 0 rgba(255, 255, 255, 0.2) inset;
}

.diagnostics-consultation-btn:active {
  transform: translateY(0);
  box-shadow: 0 2px 12px rgba(92, 184, 92, 0.3);
}

/* CTA кнопка "Исправить узкие места" с неоновой подсветкой */
.diagnostics-fix-btn {
  position: relative;
  background: linear-gradient(135deg, #00ff88 0%, #00cc6a 50%, #00ff88 100%);
  border: 2px solid #00ff88;
  box-shadow: 
    0 0 20px rgba(0, 255, 136, 0.6),
    0 0 40px rgba(0, 255, 136, 0.4),
    0 4px 20px rgba(0, 255, 136, 0.3),
    inset 0 1px 0 rgba(255, 255, 255, 0.2);
  overflow: visible;
}


.diagnostics-fix-btn .btn-glow {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 100%;
  height: 100%;
  background: radial-gradient(circle, rgba(255, 255, 255, 0.3) 0%, transparent 70%);
  border-radius: 12px;
  opacity: 0;
  transition: opacity 0.3s ease;
  pointer-events: none;
}

.diagnostics-fix-btn:hover .btn-glow {
  opacity: 1;
}

.diagnostics-fix-btn:hover {
  transform: translateY(-3px);
  box-shadow: 
    0 0 30px rgba(0, 255, 136, 0.8),
    0 0 60px rgba(0, 255, 136, 0.6),
    0 6px 28px rgba(0, 255, 136, 0.4),
    inset 0 1px 0 rgba(255, 255, 255, 0.3);
}

.diagnostics-fix-btn:active {
  transform: translateY(-1px);
  box-shadow: 
    0 0 15px rgba(0, 255, 136, 0.5),
    0 2px 12px rgba(0, 255, 136, 0.3);
}

@keyframes neon-pulse {
  0%, 100% {
    box-shadow: 
      0 0 20px rgba(0, 255, 136, 0.6),
      0 0 40px rgba(0, 255, 136, 0.4),
      0 4px 20px rgba(0, 255, 136, 0.3),
      inset 0 1px 0 rgba(255, 255, 255, 0.2);
  }
  50% {
    box-shadow: 
      0 0 30px rgba(0, 255, 136, 0.8),
      0 0 60px rgba(0, 255, 136, 0.6),
      0 6px 28px rgba(0, 255, 136, 0.5),
      inset 0 1px 0 rgba(255, 255, 255, 0.3);
  }
}

@keyframes neon-glow {
  0%, 100% {
    opacity: 0.7;
    filter: blur(10px);
  }
  50% {
    opacity: 1;
    filter: blur(15px);
  }
}

/* Финальный блок перед CTA */
.diagnostics-final-block {
  width: 100%;
  max-width: 800px;
  margin: 48px auto 32px;
  padding: 40px;
  background: linear-gradient(135deg, rgba(0, 255, 136, 0.1), rgba(0, 204, 106, 0.05));
  backdrop-filter: blur(20px);
  border: 2px solid rgba(0, 255, 136, 0.3);
  border-radius: 20px;
  box-shadow: 
    0 8px 32px rgba(0, 255, 136, 0.2),
    0 0 0 1px rgba(255, 255, 255, 0.1) inset;
  text-align: center;
  position: relative;
  overflow: hidden;
}

.diagnostics-final-block::before {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: radial-gradient(circle, rgba(0, 255, 136, 0.1) 0%, transparent 70%);
  animation: rotate-glow 20s linear infinite;
  pointer-events: none;
}

@keyframes rotate-glow {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

.final-block-icon {
  font-size: 64px;
  margin-bottom: 20px;
  filter: drop-shadow(0 0 20px rgba(0, 255, 136, 0.5));
  animation: float 3s ease-in-out infinite;
}

@keyframes float {
  0%, 100% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(-10px);
  }
}

.final-block-title {
  color: #ffffff;
  font-size: 28px;
  font-weight: 700;
  margin: 0 0 16px;
  text-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
  background: linear-gradient(135deg, #ffffff, rgba(0, 255, 136, 0.8));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.final-block-text {
  color: rgba(255, 255, 255, 0.9);
  font-size: 18px;
  line-height: 1.6;
  margin: 0 0 32px;
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
}

.final-block-benefits {
  display: flex;
  flex-direction: column;
  gap: 12px;
  align-items: center;
}

.benefit-item {
  display: flex;
  align-items: center;
  gap: 12px;
  color: #ffffff;
  font-size: 16px;
  font-weight: 500;
  padding: 12px 24px;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 12px;
  border: 1px solid rgba(255, 255, 255, 0.1);
  width: 100%;
  max-width: 400px;
  transition: all 0.3s ease;
}

.benefit-item:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(0, 255, 136, 0.3);
  transform: translateX(8px);
}

.benefit-icon {
  color: #00ff88;
  font-size: 20px;
  font-weight: 700;
  width: 28px;
  height: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(0, 255, 136, 0.2);
  border-radius: 50%;
  flex-shrink: 0;
}

/* Анимации */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Адаптивность */
@media (max-width: 768px) {
  .diagnostics-intro {
    /* Keep panel background at top; offset content with margin on .diagnostics-intro-content
       so header overlays the background consistently across tests. */
    padding: 0 16px 32px;
  }

  .diagnostics-intro-title {
    font-size: 28px;
    margin-bottom: 16px;
  }

  .diagnostics-intro-subtitle {
    font-size: 16px;
    margin-bottom: 32px;
  }

  /* Мобильные стили для Икигай */
  .ikigai-intro-main {
    font-size: 18px;
    margin-bottom: 12px;
  }

  .ikigai-intro-sub {
    font-size: 14px;
    margin-bottom: 20px;
  }

  .ikigai-instruction {
    font-size: 13px;
    line-height: 1.4;
    padding: 16px;
    margin-top: 12px;
  }

  .ikigai-instruction strong {
    font-size: 15px;
    margin-bottom: 10px;
  }

  .ikigai-instruction-emoji {
    font-size: 16px;
    margin-right: 10px;
  }

  .ikigai-instruction-title {
    font-size: 13px;
  }

  .ikigai-instruction-text {
    font-size: 12px;
  }

  .ikigai-instruction-item {
    margin-bottom: 8px;
    padding: 6px 0;
  }

  .diagnostics-start-btn {
    font-size: 16px;
    padding: 14px 36px;
  }

  .diagnostics-question {
    /* Keep background at top — content is offset by margin on .question-content so
       Header overlays consistently. Remove top padding which was pushing the
       whole panel down (caused Ikigai background to start lower). */
    padding-top: 0;
    padding-left: 12px;
    padding-right: 12px;
    padding-bottom: 0;
    height: 100%;
    flex: 1;
    min-height: 0;
    margin: 0;
    overflow: hidden;
  }
  
  .question-content {
    /* Reserve space for header by shifting the content down via margin so the
       panel background stays at the top (same behavior as Diagnostics). */
    margin-top: calc(var(--app-header-height, 100px));
    padding: 0 0 110px 0; /* on mobile leave space for options that are placed below content */
    margin: 0;
    gap: 8px;
    max-width: 100%;
    justify-content: flex-start;
    position: relative;
  }
  
  .question-content-wrapper {
    gap: 6px;
  }

  .diagnostics-progress {
    margin-bottom: 10px;
    padding: 6px 0;
    max-width: 100%;
  }
  
  .progress-text {
    font-size: 11px;
  }
  
  .progress-bar {
    height: 4px;
    margin-bottom: 4px;
  }

  .question-stage {
    flex-direction: row;
    justify-content: center;
    text-align: center;
    padding: 8px 12px;
    margin-bottom: 0;
    gap: 10px;
    border-width: 2px;
    border-radius: 10px;
  }

  .question-stage-image,
  .question-stage-emoji {
    width: 48px;
    height: 48px;
    border-width: 2px;
    border-radius: 8px;
  }

  .question-stage-emoji {
    font-size: 28px;
  }

  .question-stage-name {
    font-size: 15px;
    text-align: center;
    letter-spacing: 0.2px;
    margin-bottom: 2px;
    line-height: 1.2;
  }

  .question-stage-subtitle {
    font-size: 10px;
    line-height: 1.1;
  }

  .message-avatar {
    width: 28px;
    height: 28px;
  }

  .message-wrapper {
    gap: 4px;
    margin-bottom: 0;
  }

  .question-message {
    padding: 10px 14px;
    max-width: 65%;
    margin-left: 10px;
    border-radius: 8px;
  }

  .message-arrow {
    transform: translateY(-50%) scaleX(0.5) scaleY(1.6) !important;
    font-size: 18px !important;
    line-height: 1 !important;
    opacity: 0.8 !important;
    filter: drop-shadow(0 0 3px currentColor) !important;
  }
  
  .message-arrow-left {
    left: -12px !important;
    color: rgba(92, 184, 92, 0.9) !important;
  }
  
  .message-arrow-right {
    right: -12px !important;
    color: rgba(255, 255, 255, 0.85) !important;
  }
  
  .answer-message.poll-option.selected .message-arrow-right {
    color: rgba(51, 144, 236, 0.95) !important;
    opacity: 0.9 !important;
  }
  
  .poll-checkmark {
    right: 8px !important;
    width: 18px;
    height: 18px;
    font-size: 12px;
  }

  .question-message p {
    font-size: 12px;
    line-height: 1.3;
  }

  .answer-options {
    gap: 8px;
    /* keep options in flow on mobile as well and anchor spacing via header variable */
    position: relative;
    left: 12px;
    right: 12px;
    width: calc(100% - 24px);
    bottom: auto;
    padding-top: 12px;
  }

  .answer-message.poll-option {
    width: 100%;
    min-width: 0;
    max-width: 100%;
    height: auto;
    /* mobile/touch targets slightly larger but still driven by content */
    min-height: 40px;
    padding: 10px 14px;
    margin-right: 0 !important;
    border-radius: 8px;
    overflow: hidden;
    display: flex;
    align-items: center;
    touch-action: manipulation;
    -webkit-tap-highlight-color: rgba(51, 144, 236, 0.3);
    user-select: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
  }

  .answer-message.poll-option:hover,
  .answer-message.poll-option:active {
    transform: translateX(-1px);
    background: rgba(255, 255, 255, 0.2) !important;
  }
  
  .answer-message.poll-option.selected:active {
    background: linear-gradient(135deg, rgba(51, 144, 236, 0.45), rgba(33, 150, 243, 0.4)) !important;
  }

  .answer-option-label {
    font-size: 12px;
    margin-bottom: 0;
    line-height: 1.25;
    padding-right: 26px;
  }

  .answer-option-description {
    font-size: 10px;
    line-height: 1.1;
    padding-right: 26px;
  }

  .diagnostics-results {
    padding: 100px 10px 80px;
    width: 100%;
    min-height: calc(100vh - 120px);
    display: flex;
    align-items: flex-start;
    justify-content: center;
    box-sizing: border-box;
    padding-bottom: 80px;
  }

  .diagnostics-results-content {
    width: 100%;
    max-width: 100%;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
  }

  .diagnostics-results-title {
    font-size: 28px;
    margin-bottom: 32px;
    width: 100%;
  }

  .funnel-stage-header {
    flex-direction: column;
    text-align: center;
    gap: 12px;
  }

  .funnel-stage-image {
    width: 60px;
    height: 60px;
  }

  .funnel-stage-name {
    font-size: 20px;
  }

  .funnel-stage-score {
    font-size: 16px;
  }

  .funnel-stage-recommendation {
    font-size: 14px;
  }

  .diagnostics-analysis {
    margin-bottom: 24px;
    gap: 16px;
  }

  .analysis-section {
    border-radius: 12px;
  }

  .analysis-section-header {
    padding: 12px 16px;
    gap: 10px;
  }

  .analysis-section-title {
    font-size: 16px;
    flex-wrap: wrap;
  }

  .analysis-icon {
    font-size: 24px;
  }

  .analysis-count {
    font-size: 12px;
  }

  .analysis-section-items {
    padding: 6px;
    max-height: 300px;
    overflow-y: auto;
    overflow-x: hidden;
  }

  .analysis-item {
    padding: 10px 12px;
    margin: 3px;
  }

  .analysis-item-content {
    gap: 12px;
    flex-wrap: wrap;
  }

  .analysis-item-name {
    font-size: 14px;
    flex: 1;
    min-width: 60%;
  }

  .analysis-item-score {
    font-size: 13px;
  }

  .diagnostics-conclusion {
    margin-bottom: 24px;
    padding: 16px;
  }

  .conclusion-wrapper {
    gap: 12px;
  }

  .conclusion-avatar {
    width: 48px;
    height: 48px;
    border-width: 2px;
  }

  .conclusion-text {
    font-size: 15px;
    line-height: 1.6;
    text-align: left;
  }

  .conclusion-text strong {
    font-size: 15px;
  }
  
  .conclusion-text br {
    margin-bottom: 4px;
    line-height: 1.5;
  }

  .conclusion-text br + br {
    margin-bottom: 12px;
  }

  .conclusion-text .list-marker {
    color: rgba(92, 184, 92, 0.85);
    font-weight: 600;
    margin-right: 8px;
    display: inline-block;
    font-size: 15px;
    vertical-align: baseline;
  }

  .conclusion-text .list-number {
    color: rgba(92, 184, 92, 0.85);
    font-weight: 600;
    margin-right: 8px;
    display: inline-block;
    vertical-align: baseline;
  }

  .diagnostics-consultation {
    margin-top: 24px;
    margin-bottom: 40px;
    padding-bottom: 20px;
  }

  .diagnostics-consultation-btn {
    font-size: 16px;
    padding: 14px 36px;
    width: 100%;
  }

  .diagnostics-final-block {
    padding: 24px 16px;
    margin: 24px auto;
    width: 100%;
    max-width: 100%;
    box-sizing: border-box;
  }

  .final-block-icon {
    font-size: 48px;
    margin-bottom: 16px;
  }

  .final-block-title {
    font-size: 22px;
    margin-bottom: 12px;
  }

  .final-block-text {
    font-size: 16px;
    margin-bottom: 24px;
    display: block;
  }

  .final-block-benefits {
    display: flex;
    flex-direction: column;
    gap: 12px;
    align-items: center;
  }

  .benefit-item {
    font-size: 14px;
    padding: 10px 20px;
  }

  .benefit-icon {
    font-size: 18px;
    width: 24px;
    height: 24px;
  }
}

/* Стили для очень маленьких экранов */
@media (max-width: 480px) {
  .diagnostics-intro-title {
    font-size: 24px;
    margin-bottom: 12px;
  }

  .ikigai-intro-main {
    font-size: 16px;
    margin-bottom: 10px;
  }

  .ikigai-intro-sub {
    font-size: 13px;
    margin-bottom: 16px;
  }

  .ikigai-instruction {
    font-size: 12px;
    line-height: 1.3;
    padding: 14px;
    margin-top: 10px;
  }

  .ikigai-instruction strong {
    font-size: 14px;
    margin-bottom: 8px;
  }

  .ikigai-instruction-emoji {
    font-size: 15px;
    margin-right: 8px;
  }

  .ikigai-instruction-title {
    font-size: 12px;
  }

  .ikigai-instruction-text {
    font-size: 11px;
  }

  .ikigai-instruction-item {
    margin-bottom: 6px;
    padding: 4px 0;
  }

  .diagnostics-start-btn {
    font-size: 14px;
    padding: 12px 24px;
    width: 100%;
    max-width: 280px;
  }
}

/* IKIGAI Venn specific helpers */
.ikigai-venn-container{
  display:flex;
  align-items:center;
  justify-content:center;
  width:100%;
  max-width:520px;
  margin: 0 auto;
}
.ikigai-venn-container svg{
  width:100%;
  height:auto;
  display:block;
}

/* ensure text pills inside SVG remain readable on small screens */
.ikigai-venn-container .question-stage-name{
  font-family: inherit;
  font-weight: 700;
}

