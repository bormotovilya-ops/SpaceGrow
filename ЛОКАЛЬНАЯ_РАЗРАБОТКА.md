# Локальная разработка с чат-ботом

## Проблема

Vercel Serverless Functions (`api/chat.js`) работают **только на Vercel**, а не локально. Поэтому при запуске `npm run dev` чат не работает.

## Решение: Локальный сервер для разработки

Создан файл `server-local.js`, который эмулирует Serverless Function локально.

## Быстрый старт:

### Вариант 1: Запуск всего вместе (рекомендуется)

1. Установите зависимости (если еще не установлены):
   ```bash
   npm install
   ```

2. Создайте файл `.env` в корне проекта:
   ```
   GROQ_API_KEY=gsk_ваш_токен_здесь
   ```

3. Запустите всё одной командой:
   ```bash
   npm run dev:all
   ```
   
   Это запустит:
   - Локальный сервер на `http://localhost:5000` (для API)
   - Vite dev server на `http://localhost:3000` (для фронтенда)

### Вариант 2: Запуск в отдельных терминалах

**Терминал 1** - Локальный сервер:
```bash
npm run dev:server
```

**Терминал 2** - Фронтенд:
```bash
npm run dev
```

## Что происходит:

1. `server-local.js` запускается на порту 5000
2. Vite проксирует запросы `/api/*` на `http://localhost:5000` (уже настроено в `vite.config.js`)
3. Фронтенд отправляет запросы на `/api/chat`
4. Vite перенаправляет их на локальный сервер
5. Локальный сервер обращается к Groq API и возвращает ответ

## Структура:

```
┌─────────────┐
│   Браузер   │
│ localhost:3000
└──────┬──────┘
       │
       │ /api/chat
       ▼
┌─────────────┐
│  Vite Dev   │
│ localhost:3000
└──────┬──────┘
       │
       │ proxy → localhost:5000
       ▼
┌─────────────┐
│ Local Server│
│ localhost:5000
└──────┬──────┘
       │
       │ API запрос
       ▼
┌─────────────┐
│  Groq API   │
└─────────────┘
```

## После деплоя на Vercel:

На Vercel всё будет работать автоматически:
- Vercel распознает папку `api/` и создаст Serverless Functions
- Запросы `/api/chat` будут обрабатываться `api/chat.js`
- Локальный сервер `server-local.js` нужен только для разработки

## Устранение неполадок:

### Ошибка "Cannot find module 'express'"
```bash
npm install
```

### Ошибка "GROQ_API_KEY не настроен"
- Убедитесь, что файл `.env` существует в корне проекта
- Проверьте, что токен указан правильно: `GROQ_API_KEY=gsk_...`

### Порт 5000 уже занят
- Измените PORT в `server-local.js` на другой (например, 5001)
- Обновите `vite.config.js`: `target: 'http://localhost:5001'`

### Чат всё равно не работает
- Проверьте, что оба сервера запущены (локальный на 5000 и Vite на 3000)
- Откройте консоль браузера (F12) и проверьте ошибки
- Убедитесь, что токен Groq правильный
